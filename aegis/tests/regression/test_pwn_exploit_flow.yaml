# tests/regression/test_pwn_exploit_flow.yaml
task:
  prompt: >
    Here is a security challenge:
    1. A program at 'tests/regression/vulnerable_app.py' is vulnerable to a buffer overflow.
    2. First, you must determine the offset to control execution. Use the 'pwn_cyclic_pattern' tool to find the offset for the 4-byte value 'baaa'. Let's assume this crash value is known.
    3. Once you have the offset, use the 'pwn_process_interaction' tool to exploit the program. Craft a payload consisting of 'A' repeated for the offset, followed by the 4-byte string 'BBBB'.
    4. For verification, check if the output from the process contains the string "AEGIS{".
    5. If the flag is found, finish with a status of 'success'.

config: "verified_flow"

execution:
  iterations: 7